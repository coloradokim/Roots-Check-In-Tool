webpackJsonp([1],[function(t,e,i){function n(t){var e=l(t);if(!e&&s.isEmpty(t.groveCalendar))return null;e||s.isEmpty(t.groveCalendar)||(e=t.groveCalendar[0]),window.eventData=e,window.userData=t,renderLocationImage(e.location,e.activity||e.summary,e.creator,e.focus_area);var i=r(e.start)||r(Date.now()).add(o(),"ms");renderProgressBar(i)}var s=i(3),r=i(1),a=i(2);i(7);var o=s.partial(i(4),EVENT_LENGTH,TRANSITION_LENGTH),l=s.partialRight(i(95),EVENT_LENGTH,TRANSITION_LENGTH);renderProgressBar=function(t){a(".countDown").show();var e=r(Date.now());return t&&e.isAfter(t)?null:void a(".timer").countDown({start_time:e,end_time:t||e.add(1,"ms"),progress:a(".progress-bar"),onComplete:function(){a(".timer").show(),a(".timer").replaceWith('<div class="timer ended">Time\'s Up!</div>')},update_progress:function(t,e){50===Math.floor(t)?a(e).removeClass("progress-bar-success").addClass("progress-bar-warning"):75===Math.floor(t)&&a(e).removeClass("progress-bar-warning").addClass("progress-bar-danger"),e.attr("aria-valuenow",Math.floor(t)),e.css("width",Math.floor(t)+"%"),e.text(Math.floor(t)+"%")}})},renderLocationImage=function(t,e,i,n){t&&(a("#locationImage").empty().append(LOCATION_IMAGES[t.toLowerCase()]),a("#locationText").empty().append(t)),e&&ACTIVITY_IMAGES[e.toLowerCase()]?a("#activityImage").empty().append(ACTIVITY_IMAGES[e.toLowerCase()]):a("#activityImage").empty().append(GET_ACTIVITY(e)),a("#activityText").empty().append(e||""),i?a("#creatorImage").empty().append(CREATOR_IMAGES[i]):n&&(a("#creatorImage").empty().append(FOCUS_AREAS[n]),a("#creatorText").empty().append(n))},getCalendar=function(t){var e=r(Date.now()).startOf("day").toISOString(),i=r(Date.now()).endOf("day").toISOString();gapi.client.request("https://www.googleapis.com/calendar/v3/calendars/"+t.email+"/events/?singleEvents=true&timeMin="+e+"&timeMax="+i+"&orderBy=startTime").execute(function(e){t.calendar=s.map(e.items,function(t){return{eventId:t.id,location:t.location,creator:t.creator.displayName||t.creator.email,start:t.start.dateTime,end:t.end.dateTime,description:t.description,summary:t.summary}}),a.ajax({type:"POST",url:"api/user",data:JSON.stringify(t),contentType:"application/json",success:n}),n(t)})},signinCallback=function(t){t.status.signed_in?(a("#signinButton").hide(),a("#main-container").show(),gapi.client.request("https://www.googleapis.com/plus/v1/people/me?fields=name(familyName%2Cformatted%2CgivenName)%2CdisplayName%2Cemails%2Fvalue%2Cimage%2Furl%2Cid").execute(function(t){var e={id:t.id,name:t.displayName,email:t.emails[0].value,image:t.image.url},i=function(e){e.googleId===t.id&&window.close()},n=io.connect();n.on("SCAN!",i),a("#name").append("<h2>"+t.displayName+"'s Next Step</h2>"),a("#scan-button").attr("href","scan://scan?callback=https%3A%2F%2Froots-elementary.herokuapp.com/scanredirect/"+t.id),a(".scan-button").show(),getCalendar(e)})):console.log("Sign-in state: "+t.error)}}]);